unit Unit1;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, IdMessage, IdBaseComponent, IdComponent,
  IdTCPConnection, IdTCPClient, IdExplicitTLSClientServerBase, IdMessageClient,
  IdSMTPBase, IdSMTP, Vcl.StdCtrls, IdIOHandler, IdIOHandlerSocket,
  IdIOHandlerStack, IdSSL, IdSSLOpenSSL,IdAttachmentFile, Idtext;
  // Add IdAttachmentFile here
type
  TForm1 = class(TForm)
    IdSMTP1: TIdSMTP;
    IdMessage1: TIdMessage;
    Button1: TButton;
    IdSSLIOHandlerSocketOpenSSL1: TIdSSLIOHandlerSocketOpenSSL;
    Button2: TButton;
    IdTCPClient1: TIdTCPClient;
    Button3: TButton;
    Button4: TButton;
    procedure Button1Click(Sender: TObject);
    procedure Button2Click(Sender: TObject);
    procedure Button3Click(Sender: TObject);
    procedure Button4Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

procedure TForm1.Button1Click(Sender: TObject);
begin
  try
    IdSMTP1.Host := 'smtp.mail.yahoo.com';
    IdSMTP1.Port := 587;  // Use 587 for TLS
    IdSMTP1.Username := 'vrobert997@yahoo.com';
    IdSMTP1.Password := 'jenanqebkhkwpqit';  // Use Yahoo App Password
    IdSMTP1.IOHandler := IdSSLIOHandlerSocketOpenSSL1;
    IdSMTP1.UseTLS := utUseImplicitTLS;  // Change to utUseExplicitTLS for port 587

    IdMessage1.From.Address := 'vrobert997@yahoo.com';
    IdMessage1.Recipients.EmailAddresses := 'robertvdspoel2007@gmail.com';
    IdMessage1.Subject := 'Dangerous Mineral Transport Alert';
    IdMessage1.Body.Text := 'This is a test email from Delphi. Transport status: OK.';

    IdSMTP1.Connect;
    IdSMTP1.Send(IdMessage1);
    IdSMTP1.Disconnect;

    ShowMessage('Email sent successfully!');
  except
    on E: Exception do
      ShowMessage('Failed to send email: ' + E.Message);
  end;
end;
procedure TForm1.Button2Click(Sender: TObject);
var
  Attachment: TIdAttachmentFile;
begin
  try
    // Set up the SMTP server
    IdSMTP1.IOHandler := IdSSLIOHandlerSocketOpenSSL1;
    IdSMTP1.Host := 'smtp.mail.yahoo.com';
    IdSMTP1.Port := 465;
    IdSMTP1.Username := 'vrobert997@yahoo.com';
    IdSMTP1.Password := 'jenanqebkhkwpqit';
    IdSMTP1.UseTLS := utUseImplicitTLS;

    // Set up the email message
    IdMessage1.ContentType := 'multipart/related';
    IdMessage1.From.Address := 'vrobert997@yahoo.com';
    IdMessage1.Recipients.EmailAddresses := 'robertvdspoel2007@gmail.com';
    IdMessage1.Subject := 'Email with Background Image';

    // Add HTML content with an embedded image
    IdMessage1.Body.Text :=
      '<html>' +
      //'<body style="background-image: url(''cid:background''); background-size: cover;">' +
      //'<h1 style="color: white; text-align: center;">Dangerous Mineral Transport Alert</h1>' +
      '<body style="text-align: center; background-color: black;">' +
       '<img src="cid:background" width="100%" alt="Background Image">'+
      '<p style="color: white; text-align: center;">Please check the shipment status.</p>' +
      '</body>' +
      '</html>';

    // Attach the image and set its Content-ID
    Attachment := TIdAttachmentFile.Create(IdMessage1.MessageParts, 'IMG_1229.JPG');
    Attachment.ContentID := 'background';
    Attachment.ContentType := 'image/jpg';
    Attachment.DisplayName := 'Background Image';

    // Send the email
    IdSMTP1.Connect;
    IdSMTP1.Send(IdMessage1);
    IdSMTP1.Disconnect;

    ShowMessage('Email sent successfully!');
  except
    on E: Exception do
      ShowMessage('Failed to send email: ' + E.Message);
  end;
end;

procedure TForm1.Button3Click(Sender: TObject);
var
  HTMLTextPart: TIdText;
begin
  try
    // Set up SMTP
    IdSMTP1.IOHandler := IdSSLIOHandlerSocketOpenSSL1;
    IdSMTP1.Host := 'smtp.mail.yahoo.com';
    IdSMTP1.Port := 465;
    IdSMTP1.Username := 'vrobert997@yahoo.com';
    IdSMTP1.Password := 'jenanqebkhkwpqit';
    IdSMTP1.UseTLS := utUseImplicitTLS;

    // Configure Email
    IdMessage1.ContentType := 'multipart/related';
    IdMessage1.From.Address := 'vrobert997@yahoo.com';
    IdMessage1.Recipients.EmailAddresses := 'robertvdspoel2007@gmail.com';
    IdMessage1.Subject := 'Email with Online Background Image';

    // Create HTML part with an online image URL
    HTMLTextPart := TIdText.Create(IdMessage1.MessageParts);
    HTMLTextPart.ContentType := 'text/html';
    HTMLTextPart.Body.Text :=
      '<html>' +
      '<body style="text-align: center; background-color: black;">' +
      // Use the direct URL of the hosted image
     // '<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/50/S%C3%A9randite%2C_natrolite%2C_analcime%2C_aegirine_300-4-2112.JPG/330px-S%C3%A9randite%2C_natrolite%2C_analcime%2C_aegirine_300-4-2112.JPG" width="100%" alt="Background Image">' +

    '<img src="https://drive.google.com/uc?export=view&id=19Fv1DpS0dLp2yleANF58quK4L-pDW-pF" width="100%" alt="Background Image">'+
      '<h1 style="color: white;">Dangerous Mineral Transport Alert</h1>' +
      '<p style="color: white;">Please check the shipment status.</p>' +
      '</body>' +
      '</html>';

    // Send Email
    IdSMTP1.Connect;
    IdSMTP1.Send(IdMessage1);
    IdSMTP1.Disconnect;

    ShowMessage('Email sent successfully!');
  except
    on E: Exception do
      ShowMessage('Failed to send email: ' + E.Message);
  end;
end;
procedure TForm1.Button4Click(Sender: TObject);
var
  HTMLTextPart: TIdText;
begin
  try
    // Set up SMTP
    IdSMTP1.IOHandler := IdSSLIOHandlerSocketOpenSSL1;
    IdSMTP1.Host := 'smtp.mail.yahoo.com';
    IdSMTP1.Port := 465;
    IdSMTP1.Username := 'vrobert997@yahoo.com';
    IdSMTP1.Password := 'jenanqebkhkwpqit';
    IdSMTP1.UseTLS := utUseImplicitTLS;

    // Configure Email
    IdMessage1.ContentType := 'multipart/alternative';
    IdMessage1.From.Address := 'vrobert997@yahoo.com';
    IdMessage1.Recipients.EmailAddresses := 'mpdejager2@gmail.com';
    IdMessage1.Subject := 'Dangerous Mineral Transport Alert:   : HALLLO';

    // Create HTML content with a colored, custom background
    HTMLTextPart := TIdText.Create(IdMessage1.MessageParts);
    HTMLTextPart.ContentType := 'text/html';
    HTMLTextPart.Body.Text :=
      '<html>' +
      '<head>' +
      '<style>' +
      '  body { background-color: #1e1e1e; color: white; font-family: Arial, sans-serif; text-align: center; padding: 20px; }' +
      '  .container { max-width: 600px; margin: auto; padding: 20px; background: #333; border-radius: 10px; }' +
      '  h1 { color: #ffcc00; }' +
      '  p { font-size: 16px; }' +
      '</style>' +
      '</head>' +
      '<body>' +
      '  <div class="container">' +
      '    <h1> Dangerous Mineral Transport Alert </h1>' +
      '    <p>Please check the shipment status immediately.</p>' +
      '  </div>' +
      '</body>' +
      '</html>';

    // Send Email
    IdSMTP1.Connect;
    IdSMTP1.Send(IdMessage1);
    IdSMTP1.Disconnect;

    ShowMessage('Email sent successfully!');
  except
    on E: Exception do
      ShowMessage('Failed to send email: ' + E.Message);
  end;
end;

end.
